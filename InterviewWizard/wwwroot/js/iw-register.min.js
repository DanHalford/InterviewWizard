/*! asp.net 2025-01-30 */
var oldEmail="";function validateEmail(t){if(t.value!==oldEmail){var e=t.value;if(0!=e.length)if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e))return fetch(`/auth/${e}/exists`,{method:"GET",headers:{"Cache-Control":"no-cache"},cache:"no-cache"}).then(e=>{console.log(e.status),204===e.status?illustrateControlValidity(t,!0):(illustrateControlValidity(t,!1),document.getElementById("lblInvalidEmail").innerHTML="The email you have entered is already registered. Use the profile icon top right to sign in.")}).catch(e=>{illustrateControlValidity(t,!1),document.getElementById("lblInvalidEmail").innerHTML="An error occurred checking your email address. Please try again."});illustrateControlValidity(t,!1),document.getElementById("lblInvalidEmail").innerHTML="Please enter a valid email address."}}function illustrateControlValidity(e,t){t?(e.classList.remove("is-invalid"),e.classList.add("is-valid")):(e.classList.remove("is-valid"),e.classList.add("is-invalid"))}document.addEventListener("DOMContentLoaded",function(){document.getElementById("frmRegister").addEventListener("submit",function(e){e.preventDefault(),e.stopPropagation();var e=document.getElementById("EmailAddress"),t=(validateEmail(e),document.getElementById("Password")),a=(illustrateControlValidity(t,14<=t.value.length),document.getElementById("ConfirmPassword")),a=(illustrateControlValidity(a,a.value===t.value),document.querySelectorAll("*[data-iw-validate]").forEach(function(e){e.classList.contains("is-invalid")}),document.getElementById("cmdSubmit").classList.add("disabled"),document.getElementById("cmdSubmit").innerHTML='<span class="spinner-border spinner-border-sm" aria-hidden="true"></span><span class="visually-hidden" role="status">Registering...</span>',document.querySelector('input[name="__RequestVerificationToken"]').value);fetch("/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e.value,password:t.value,token:a})}).then(e=>{201===e.status?(e=e.headers.get("Token"),document.location="/verify-account?token="+e):(document.getElementById("cmdSubmit").classList.remove("disabled"),document.getElementById("cmdSubmit").innerHTML="Sign up",DisplayAlert("lblStatus",AlertTypes.Error,'An error occurred trying to create your account. Please try again. If the error persists, <a href="/contact?subject=Registration Error" class="link-danger" aria-label="Contact form">let us know</a>.'))}).catch(e=>{document.getElementById("cmdSubmit").classList.remove("disabled"),document.getElementById("cmdSubmit").innerHTML="Sign up",DisplayAlert("lblStatus",AlertTypes.Error,'An error occurred trying to create your account. Please try again. If the error persists, <a href="/contact?subject=Registration Error" class="link-danger" aria-label="Contact form">let us know</a>.')})}),document.getElementById("EmailAddress").addEventListener("blur",function(e){validateEmail(this)})});